// filteratomic.cxx
#   pragma omp critical
    if (threadnum==ithread) {
      filtered += local;
      ithread++;
